<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏßÄÎ¢∞ Ï∞æÍ∏∞</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #bdbdbd;
            display: flex;
            justify-content: center;
            margin: 20px;
        }
        #game {
            background: #c0c0c0;
            padding: 12px;
            border: 3px outset #fff;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            max-width: 95vw;
        }
        #header {
            background: #c0c0c0;
            border: 2px inset #c0c0c0;
            margin-bottom: 10px;
            padding: 8px;
        }
        #top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }
        #difficulty-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            font-size: 14px;
        }
        #difficulty {
            border: 2px inset #fff;
            background: #e0e0e0;
            padding: 4px 6px;
            font-size: 14px;
        }
        #helper-text {
            margin-top: 10px;
            font-size: 13px;
            text-align: center;
            color: #333;
        }
        .display {
            background: black;
            color: red;
            font-family: 'Courier New', monospace;
            font-size: 28px;
            font-weight: bold;
            padding: 4px 12px;
            letter-spacing: 3px;
            min-width: 72px;
            text-align: center;
        }
        #smiley {
            width: 52px;
            height: 52px;
            font-size: 40px;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        #smiley:active {
            border: 2px inset #c0c0c0;
        }
        #board {
            display: inline-grid;
            gap: 1px;
            background: black;
            padding: 5px;
            overflow: auto;
            max-width: 100%;
        }
        .cell {
            width: 30px;
            height: 30px;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: default;
            user-select: none;
            font-size: 16px;
        }
        .cell:active {
            border: 2px inset #c0c0c0;
        }
        .revealed {
            border: 1px solid #808080;
            background: #e0e0e0;
            cursor: default;
        }
        .mine { background: red; }
        .wrong { color: red; }
        .n1 { color: #0000ff; }
        .n2 { color: #008000; }
        .n3 { color: #ff0000; }
        .n4 { color: #000080; }
        .n5 { color: #800000; }
        .n6 { color: #008080; }
        .n7 { color: #000000; }
        .n8 { color: #808080; }
    </style>
</head>
<body>
    <div id="game">
        <div id="header">
            <div id="top-bar">
                <div id="mine-count" class="display">010</div>
                <div id="smiley" onclick="reset()">üòä</div>
                <div id="timer" class="display">000</div>
            </div>
            <div id="difficulty-control">
                <label for="difficulty">ÎÇúÏù¥ÎèÑ ÏÑ†ÌÉù:</label>
                <select id="difficulty"></select>
            </div>
        </div>
        <div id="board"></div>
        <p id="helper-text">ÏôºÏ™Ω ÌÅ¥Î¶≠: Ïó¥Í∏∞ ¬∑ Ïò§Î•∏Ï™Ω ÌÅ¥Î¶≠: ÍπÉÎ∞ú ¬∑ Ï≤´ ÌÅ¥Î¶≠ÏùÄ Ìï≠ÏÉÅ ÏïàÏ†ÑÌï©ÎãàÎã§!</p>
    </div>
    <script>
        const DIFFICULTIES = {
            beginner: { label: 'Ï¥àÍ∏â (9√ó9)', rows: 9, cols: 9, mines: 10 },
            intermediate: { label: 'Ï§ëÍ∏â (16√ó16)', rows: 16, cols: 16, mines: 40 },
            expert: { label: 'Í≥†Í∏â (16√ó30)', rows: 16, cols: 30, mines: 99 }
        };
        let currentDifficulty = 'beginner';
        let ROWS = DIFFICULTIES[currentDifficulty].rows;
        let COLS = DIFFICULTIES[currentDifficulty].cols;
        let TOTAL_MINES = DIFFICULTIES[currentDifficulty].mines;
        let board = [], cells = [], flags = 0, revealed = 0, gameOver = false, first = true, timer, sec = 0;
        function initDifficultyOptions() {
            const select = document.getElementById('difficulty');
            select.innerHTML = '';
            Object.entries(DIFFICULTIES).forEach(([key, diff]) => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${diff.label} ¬∑ üí£${String(diff.mines).padStart(2, '0')}`;
                select.appendChild(option);
            });
            select.value = currentDifficulty;
            select.onchange = e => {
                currentDifficulty = e.target.value;
                applyDifficulty();
                reset();
            };
        }
        function applyDifficulty() {
            const diff = DIFFICULTIES[currentDifficulty];
            ROWS = diff.rows;
            COLS = diff.cols;
            TOTAL_MINES = diff.mines;
        }
        function reset() {
            clearInterval(timer);
            sec = 0; flags = 0; revealed = 0; gameOver = false; first = true;
            document.getElementById('timer').textContent = '000';
            updateMineCount();
            document.getElementById('smiley').textContent = 'üòä';
            createBoard();
        }
        function updateMineCount() {
            document.getElementById('mine-count').textContent = String(Math.max(TOTAL_MINES - flags, 0)).padStart(3, '0');
        }
        function createBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            boardEl.style.gridTemplateRows = `repeat(${ROWS}, 30px)`;
            boardEl.style.gridTemplateColumns = `repeat(${COLS}, 30px)`;
            board = Array.from({ length: ROWS }, () => Array.from({ length: COLS }, () => ({ mine: false, revealed: false, flag: false, num: 0 })));
            cells = [];
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const div = document.createElement('div');
                    div.className = 'cell';
                    div.onmousedown = e => handleClick(e, r, c);
                    div.oncontextmenu = e => { e.preventDefault(); handleFlag(r, c); };
                    boardEl.appendChild(div);
                    cells.push(div);
                }
            }
        }
        function placeMines(excludeR, excludeC) {
            let placed = 0;
            while (placed < TOTAL_MINES) {
                const r = Math.floor(Math.random() * ROWS);
                const c = Math.floor(Math.random() * COLS);
                if (!board[r][c].mine && !(r === excludeR && c === excludeC)) {
                    board[r][c].mine = true;
                    placed++;
                }
            }
            calcNumbers();
        }
        function calcNumbers() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (board[r][c].mine) continue;
                    let count = 0;
                    for (let dr = -1; dr <= 1; dr++) {
                        for (let dc = -1; dc <= 1; dc++) {
                            if (dr === 0 && dc === 0) continue;
                            const nr = r + dr, nc = c + dc;
                            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && board[nr][nc].mine) count++;
                        }
                    }
                    board[r][c].num = count;
                }
            }
        }
        function handleClick(e, r, c) {
            if (gameOver || board[r][c].revealed || board[r][c].flag) return;
            if (e.button === 0) {
                if (first) {
                    first = false;
                    placeMines(r, c);
                    timer = setInterval(() => {
                        sec = Math.min(sec + 1, 999);
                        document.getElementById('timer').textContent = String(sec).padStart(3, '0');
                    }, 1000);
                }
                reveal(r, c);
            }
        }
        function handleFlag(r, c) {
            if (gameOver || board[r][c].revealed) return;
            board[r][c].flag = !board[r][c].flag;
            flags += board[r][c].flag ? 1 : -1;
            cells[r * COLS + c].textContent = board[r][c].flag ? 'üö©' : '';
            updateMineCount();
            checkWin();
        }
        function reveal(r, c) {
            if (r < 0 || r >= ROWS || c < 0 || c >= COLS || board[r][c].revealed || board[r][c].flag) return;
            board[r][c].revealed = true;
            revealed++;
            const cell = cells[r * COLS + c];
            cell.classList.add('revealed');
            if (board[r][c].mine) {
                cell.textContent = 'üí£';
                cell.classList.add('mine');
                gameOver = true;
                document.getElementById('smiley').textContent = 'üòµ';
                clearInterval(timer);
                revealAll();
                return;
            }
            if (board[r][c].num > 0) {
                cell.textContent = board[r][c].num;
                cell.classList.add('n' + board[r][c].num);
            } else {
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        reveal(r + dr, c + dc);
                    }
                }
            }
            checkWin();
        }
        function revealAll() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cell = cells[r * COLS + c];
                    if (board[r][c].mine && !board[r][c].flag) {
                        cell.textContent = 'üí£';
                        cell.classList.add('revealed');
                    } else if (!board[r][c].mine && board[r][c].flag) {
                        cell.textContent = '‚úñ';
                        cell.classList.add('wrong');
                    }
                }
            }
        }
        function checkWin() {
            if (revealed === ROWS * COLS - TOTAL_MINES) {
                gameOver = true;
                document.getElementById('smiley').textContent = 'üòé';
                clearInterval(timer);
            }
        }
        applyDifficulty();
        initDifficultyOptions();
        reset();
    </script>
</body>
</html>
