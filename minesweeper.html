<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ë¢° ì°¾ê¸°</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #bdbdbd;
            display: flex;
            justify-content: center;
            margin: 20px;
        }
        #game {
            background: #c0c0c0;
            padding: 10px;
            border: 3px outset #fff;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #c0c0c0;
            padding: 8px;
            border: 2px inset #c0c0c0;
            margin-bottom: 10px;
        }
        .display {
            background: black;
            color: red;
            font-family: 'Courier New', monospace;
            font-size: 28px;
            font-weight: bold;
            padding: 4px 12px;
            letter-spacing: 3px;
        }
        #smiley {
            width: 52px;
            height: 52px;
            font-size: 40px;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        #smiley:active {
            border: 2px inset #c0c0c0;
        }
        #board {
            display: inline-grid;
            gap: 1px;
            background: black;
            padding: 5px;
        }
        .cell {
            width: 30px;
            height: 30px;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: default;
            user-select: none;
        }
        .cell:active {
            border: 2px inset #c0c0c0;
        }
        .revealed {
            border: 1px solid #808080;
            background: #e0e0e0;
            cursor: default;
        }
        .mine { background: red; }
        .wrong { color: red; }
        .n1 { color: #0000ff; }
        .n2 { color: #008000; }
        .n3 { color: #ff0000; }
        .n4 { color: #000080; }
        .n5 { color: #800000; }
        .n6 { color: #008080; }
        .n7 { color: #000000; }
        .n8 { color: #808080; }
    </style>
</head>
<body>
    <div id="game">
        <div id="header">
            <div id="mine-count" class="display">010</div>
            <div id="smiley" onclick="reset()">ðŸ˜Š</div>
            <div id="timer" class="display">000</div>
        </div>
        <div id="board"></div>
    </div>
    <script>
        const ROWS = 9, COLS = 9, TOTAL_MINES = 10;
        let board = [], cells = [], flags = 0, revealed = 0, gameOver = false, first = true, timer, sec = 0;
        function reset() {
            clearInterval(timer);
            sec = 0; flags = 0; revealed = 0; gameOver = false; first = true;
            document.getElementById('timer').textContent = '000';
            document.getElementById('mine-count').textContent = '010';
            document.getElementById('smiley').textContent = 'ðŸ˜Š';
            createBoard();
        }
        function createBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            boardEl.style.gridTemplate = `repeat(${ROWS}, 30px) / repeat(${COLS}, 30px)`;
            board = Array(ROWS).fill().map(() => Array(COLS).fill().map(() => ({mine: false, revealed: false, flag: false, num: 0})));
            cells = [];
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const div = document.createElement('div');
                    div.className = 'cell';
                    div.onmousedown = e => handleClick(e, r, c);
                    div.oncontextmenu = e => { e.preventDefault(); handleFlag(r, c); };
                    boardEl.appendChild(div);
                    cells.push(div);
                }
            }
        }
        function placeMines(excludeR, excludeC) {
            let placed = 0;
            while (placed < TOTAL_MINES) {
                const r = Math.floor(Math.random() * ROWS);
                const c = Math.floor(Math.random() * COLS);
                if (!board[r][c].mine && !(r === excludeR && c === excludeC)) {
                    board[r][c].mine = true;
                    placed++;
                }
            }
            calcNumbers();
        }
        function calcNumbers() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (board[r][c].mine) continue;
                    let count = 0;
                    for (let dr = -1; dr <= 1; dr++) {
                        for (let dc = -1; dc <= 1; dc++) {
                            if (dr === 0 && dc === 0) continue;
                            const nr = r + dr, nc = c + dc;
                            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && board[nr][nc].mine) count++;
                        }
                    }
                    board[r][c].num = count;
                }
            }
        }
        function handleClick(e, r, c) {
            if (gameOver || board[r][c].revealed || board[r][c].flag) return;
            if (e.button === 0) { // ì™¼ìª½ í´ë¦­
                if (first) {
                    first = false;
                    placeMines(r, c);
                    timer = setInterval(() => {
                        sec++;
                        document.getElementById('timer').textContent = String(sec).padStart(3, '0');
                    }, 1000);
                }
                reveal(r, c);
            }
        }
        function handleFlag(r, c) {
            if (gameOver || board[r][c].revealed) return;
            board[r][c].flag = !board[r][c].flag;
            flags += board[r][c].flag ? 1 : -1;
            cells[r * COLS + c].textContent = board[r][c].flag ? 'ðŸš©' : '';
            document.getElementById('mine-count').textContent = String(TOTAL_MINES - flags).padStart(3, '0');
            checkWin();
        }
        function reveal(r, c) {
            if (r < 0 || r >= ROWS || c < 0 || c >= COLS || board[r][c].revealed || board[r][c].flag) return;
            board[r][c].revealed = true;
            revealed++;
            const cell = cells[r * COLS + c];
            cell.classList.add('revealed');
            if (board[r][c].mine) {
                cell.textContent = 'ðŸ’£';
                cell.classList.add('mine');
                gameOver = true;
                document.getElementById('smiley').textContent = 'ðŸ˜µ';
                clearInterval(timer);
                revealAll();
                return;
            }
            if (board[r][c].num > 0) {
                cell.textContent = board[r][c].num;
                cell.classList.add('n' + board[r][c].num);
            } else {
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        reveal(r + dr, c + dc);
                    }
                }
            }
            checkWin();
        }
        function revealAll() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cell = cells[r * COLS + c];
                    if (board[r][c].mine && !board[r][c].flag) {
                        cell.textContent = 'ðŸ’£';
                        cell.classList.add('revealed');
                    } else if (!board[r][c].mine && board[r][c].flag) {
                        cell.textContent = 'âœ–';
                        cell.classList.add('wrong');
                    }
                }
            }
        }
        function checkWin() {
            if (revealed === ROWS * COLS - TOTAL_MINES) {
                gameOver = true;
                document.getElementById('smiley').textContent = 'ðŸ˜Ž';
                clearInterval(timer);
            }
        }
        reset();
    </script>
</body>
</html>
